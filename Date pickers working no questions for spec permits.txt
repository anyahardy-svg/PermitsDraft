
import React, { useState } from 'react';
import { useEffect } from 'react';
import { StyleSheet, View, TouchableOpacity, Text, TextInput, Switch, FlatList, ScrollView, Alert } from 'react-native';

// Simple error boundary for debugging
function ErrorBoundary({ children }) {
  const [error, setError] = React.useState(null);
  if (error) {
    return (
      <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center', backgroundColor: '#fff' }}>
        <Text style={{ color: 'red', fontSize: 18, margin: 20 }}>Error: {String(error)}</Text>
      </View>
    );
  }
  // Not actually used in this file, but if you want to use it, wrap children with try/catch or use an error boundary library
  return children;
}

// Specialized Permit Types
const specializedPermitTypes = [
  { key: 'hotWork', label: 'Hot Work Permit', description: 'Welding, cutting, grinding, brazing' },
  { key: 'confinedSpace', label: 'Confined Space Entry', description: 'Tanks, vessels, pits, manholes' },
  { key: 'workingAtHeight', label: 'Working at Height', description: 'Ladders, scaffolds, rooftops' },
  { key: 'electrical', label: 'Electrical Work', description: 'Live electrical work, isolation' },
  { key: 'excavation', label: 'Excavation and Demolition', description: 'Digging, trenching, demolition work' },
  { key: 'lifting', label: 'Lifting with Crane or HIAB', description: 'Cranes, hoists, lifting equipment' },
  { key: 'blasting', label: 'Marking, Drilling & Blasting', description: 'Explosive work, quarry operations' },
  { key: 'plantServicing', label: 'Mobile and Fixed Plant Servicing', description: 'Equipment maintenance and repair' },
  { key: 'stripping', label: 'Stripping Work', description: 'Site preparation, overburden removal' },
  { key: 'surveying', label: 'Surveying and Pedestrian Access', description: 'Survey work, pedestrian access to operational areas' },
  { key: 'conveyorServicing', label: 'Conveyor Servicing', description: 'Conveyor belt replacement and maintenance' }
];

// Single Hazard Types
const singleHazardTypes = [
  { key: 'slip', label: 'Slip Hazard', description: 'Wet surfaces, spills' },
  { key: 'trip', label: 'Trip Hazard', description: 'Cables, uneven surfaces' },
  { key: 'fall', label: 'Fall Hazard', description: 'Open edges, holes' },
  { key: 'crush', label: 'Crush Hazard', description: 'Heavy objects, machinery' },
  { key: 'cut', label: 'Cut Hazard', description: 'Sharp edges, blades' },
  { key: 'burn', label: 'Burn Hazard', description: 'Hot surfaces, steam' },
  { key: 'chemical', label: 'Chemical Exposure', description: 'Skin/eye contact, inhalation' },
  { key: 'electrical', label: 'Electrical Hazard', description: 'Live circuits, static' },
  { key: 'noise', label: 'Noise Exposure', description: 'Loud machinery, tools' },
  { key: 'vibration', label: 'Vibration Exposure', description: 'Power tools, machinery' },
  { key: 'dust', label: 'Dust Exposure', description: 'Particulates, debris' },
  { key: 'fumes', label: 'Fume Exposure', description: 'Welding, chemical fumes' }
];
const PermitManagementApp = () => {
  // --- Render New Permit Form ---
  // Add state for End Date picker
  const [showEndDatePicker, setShowEndDatePicker] = useState(false);

  // Default start date/time to now on first render
  React.useEffect(() => {
    if (!formData.startDate) {
      const now = new Date();
      setFormData(prev => ({
        ...prev,
        startDate: now.toISOString().slice(0, 10),
        startTime: now.toTimeString().slice(0, 5),
      }));
    }
  }, []);

  function renderNewPermitForm() {
    return (
      <View style={{ flex: 1, backgroundColor: '#F9FAFB' }}>
        {/* General Section */}
        <ScrollView contentContainerStyle={styles.formContainer}>
          <View style={styles.section}>
            <TouchableOpacity style={styles.sectionHeader} onPress={() => toggleSection('general')}>
              <Text style={styles.sectionTitle}>General</Text>
              <Text style={styles.expandIcon}>{expandedSections.general ? '‚ñ≤' : '‚ñº'}</Text>
            </TouchableOpacity>
            {expandedSections.general && (
              <View style={styles.sectionContent}>
                <Text style={styles.label}>Permit ID</Text>
                <TextInput
                  style={styles.input}
                  value={formData?.id || ''}
                  onChangeText={text => setFormData({ ...formData, id: text })}
                  placeholder="Permit ID"
                />
                <Text style={styles.label}>Work Description</Text>
                <TextInput
                  style={[styles.input, styles.textArea]}
                  multiline
                  numberOfLines={3}
                  value={formData?.description || ''}
                  onChangeText={text => setFormData({ ...formData, description: text })}
                  placeholder="Describe the work to be performed..."
                />
                <Text style={styles.label}>Location</Text>
                <TextInput
                  style={styles.input}
                  value={formData?.location || ''}
                  onChangeText={text => setFormData({ ...formData, location: text })}
                  placeholder="Work location"
                />
                <Text style={styles.label}>Requested By</Text>
                <TextInput
                  style={styles.input}
                  value={formData?.requestedBy || ''}
                  onChangeText={text => setFormData({ ...formData, requestedBy: text })}
                  placeholder="Your name"
                />
                {/* Start/End Date & Time Pickers */}
                <View style={styles.dateTimeRow}>
                  <View style={styles.dateTimeColumn}>
                    <Text style={styles.label}>Start Date</Text>
                    <TouchableOpacity
                      style={styles.dateTimeInput}
                      onPress={() => setShowStartDatePicker(true)}
                    >
                      <Text style={formData.startDate ? styles.dateTimeText : styles.placeholderText}>
                        {formData.startDate ? formatDate(formData.startDate) : 'Select start date'}
                      </Text>
                      <Text style={styles.calendarIcon}>üìÖ</Text>
                    </TouchableOpacity>
                  </View>
                  <View style={styles.dateTimeColumn}>
                    <Text style={styles.label}>Start Time</Text>
                    <TouchableOpacity
                      style={styles.dateTimeInput}
                      onPress={() => setShowStartTimePicker(true)}
                    >
                      <Text style={formData.startTime ? styles.dateTimeText : styles.placeholderText}>
                        {formData.startTime ? formatTime(formData.startTime) : 'Select start time'}
                      </Text>
                      <Text style={styles.calendarIcon}>‚è∞</Text>
                    </TouchableOpacity>
                  </View>
                </View>
                <View style={styles.dateTimeRow}>
                  <View style={styles.dateTimeColumn}>
                    <Text style={styles.label}>End Date</Text>
                    <TouchableOpacity
                      style={styles.dateTimeInput}
                      onPress={() => setShowEndDatePicker(true)}
                    >
                      <Text style={formData.endDate ? styles.dateTimeText : styles.placeholderText}>
                        {formData.endDate ? formatDate(formData.endDate) : 'Select end date'}
                      </Text>
                      <Text style={styles.calendarIcon}>üìÖ</Text>
                    </TouchableOpacity>
                  </View>
                  <View style={styles.dateTimeColumn}>
                    <Text style={styles.label}>End Time</Text>
                    <TouchableOpacity
                      style={styles.dateTimeInput}
                      onPress={() => setShowEndTimePicker(true)}
                    >
                      <Text style={formData.endTime ? styles.dateTimeText : styles.placeholderText}>
                        {formData.endTime ? formatTime(formData.endTime) : 'Select end time'}
                      </Text>
                      <Text style={styles.calendarIcon}>‚è∞</Text>
                    </TouchableOpacity>
                  </View>
                </View>
              </View>
            )}
          </View>
          {/* Specialized Permits Section */}
          <View style={styles.section}>
            <TouchableOpacity style={styles.sectionHeader} onPress={() => toggleSection('specialized')}>
              <Text style={styles.sectionTitle}>Specialized Permits</Text>
              <Text style={styles.expandIcon}>{expandedSections.specialized ? '‚ñ≤' : '‚ñº'}</Text>
            </TouchableOpacity>
            {expandedSections.specialized && (
              <View style={styles.sectionContent}>
                {specializedPermitTypes.map(permit => (
                  <View key={permit.key} style={{ marginBottom: 16, borderBottomWidth: 1, borderBottomColor: '#E5E7EB', paddingBottom: 12 }}>
                    <View style={{ flexDirection: 'row', alignItems: 'center', marginBottom: 4 }}>
                      <Switch
                        value={formData?.specializedPermits?.[permit.key]?.required || false}
                        onValueChange={val => handleSpecializedPermitChange(permit.key, 'required', val)}
                      />
                      <Text style={{ marginLeft: 8, fontWeight: 'bold' }}>{permit.label}</Text>
                    </View>
                    <Text style={{ color: '#6B7280', marginBottom: 4 }}>{permit.description}</Text>
                    {formData?.specializedPermits?.[permit.key]?.required && (
                      <>
                        {renderQuestionnaire(permit.key, formData, handleQuestionnaireResponse, permitQuestionnaires, styles)}
                      </>
                    )}
                  </View>
                ))}
              </View>
            )}
          </View>
          {/* Single Hazards Section */}
          <View style={styles.section}>
            <TouchableOpacity style={styles.sectionHeader} onPress={() => toggleSection('hazards')}>
              <Text style={styles.sectionTitle}>Single Hazards</Text>
              <Text style={styles.expandIcon}>{expandedSections.hazards ? '‚ñ≤' : '‚ñº'}</Text>
            </TouchableOpacity>
            {expandedSections.hazards && (
              <View style={styles.sectionContent}>
                {singleHazardTypes.map(hazard => (
                  <View key={hazard.key} style={{ marginBottom: 16, borderBottomWidth: 1, borderBottomColor: '#E5E7EB', paddingBottom: 12 }}>
                    <View style={{ flexDirection: 'row', alignItems: 'center', marginBottom: 4 }}>
                      <Switch
                        value={formData?.singleHazards?.[hazard.key]?.present || false}
                        onValueChange={val => handleSingleHazardChange(hazard.key, 'present', val)}
                      />
                      <Text style={{ marginLeft: 8, fontWeight: 'bold' }}>{hazard.label}</Text>
                    </View>
                    <Text style={{ color: '#6B7280', marginBottom: 4 }}>{hazard.description}</Text>
                    {formData?.singleHazards?.[hazard.key]?.present && (
                      <>
                        <TextInput
                          style={styles.input}
                          value={formData.singleHazards[hazard.key]?.controls || ''}
                          onChangeText={text => handleSingleHazardChange(hazard.key, 'controls', text)}
                          placeholder="Describe controls for this hazard"
                        />
                      </>
                    )}
                  </View>
                ))}
              </View>
            )}
          </View>
          {/* JSEA Section */}
          <View style={styles.section}>
            <TouchableOpacity style={styles.sectionHeader} onPress={() => toggleSection('jsea')}>
              <Text style={styles.sectionTitle}>JSEA</Text>
              <Text style={styles.expandIcon}>{expandedSections.jsea ? '‚ñ≤' : '‚ñº'}</Text>
            </TouchableOpacity>
            {expandedSections.jsea && (
              <View style={styles.sectionContent}>
                <Text style={styles.label}>Task Steps</Text>
                {formData?.jsea?.taskSteps?.map((step, idx) => (
                  <View key={idx} style={styles.jseaStep}>
                    <View style={styles.stepHeader}>
                      <Text style={styles.stepTitle}>Step {idx + 1}</Text>
                      <TouchableOpacity onPress={() => removeJSEAStep(idx)}>
                        <Text style={styles.removeButton}>Remove</Text>
                      </TouchableOpacity>
                    </View>
                    <TextInput
                      style={styles.input}
                      value={step.step}
                      onChangeText={text => updateJSEAStep(idx, 'step', text)}
                      placeholder="Describe step"
                    />
                    <TextInput
                      style={styles.input}
                      value={step.hazards}
                      onChangeText={text => updateJSEAStep(idx, 'hazards', text)}
                      placeholder="Hazards for this step"
                    />
                    <TextInput
                      style={styles.input}
                      value={step.controls}
                      onChangeText={text => updateJSEAStep(idx, 'controls', text)}
                      placeholder="Controls for this step"
                    />
                    <View style={styles.riskButtons}>
                      {['low', 'medium', 'high'].map(risk => (
                        <TouchableOpacity
                          key={risk}
                          style={[
                            styles.riskButton,
                            { backgroundColor: step.riskLevel === risk ? getRiskColor(risk) : '#E5E7EB' }
                          ]}
                          onPress={() => updateJSEAStep(idx, 'riskLevel', risk)}
                        >
                          <Text style={[
                            styles.riskButtonText,
                            { color: step.riskLevel === risk ? 'white' : '#374151' }
                          ]}>{risk.toUpperCase()}</Text>
                        </TouchableOpacity>
                      ))}
                    </View>
                  </View>
                ))}
                <TouchableOpacity style={styles.addButton} onPress={addJSEAStep}>
                  <Text style={styles.addButtonText}>Add Step</Text>
                </TouchableOpacity>
                <Text style={styles.label}>Overall Risk Rating</Text>
                <View style={styles.riskButtons}>
                  {['low', 'medium', 'high'].map(risk => (
                    <TouchableOpacity
                      key={risk}
                      style={[
                        styles.riskButton,
                        { backgroundColor: formData?.jsea?.overallRiskRating === risk ? getRiskColor(risk) : '#E5E7EB' }
                      ]}
                      onPress={() => setFormData({ ...formData, jsea: { ...formData.jsea, overallRiskRating: risk } })}
                    >
                      <Text style={[
                        styles.riskButtonText,
                        { color: formData?.jsea?.overallRiskRating === risk ? 'white' : '#374151' }
                      ]}>{risk.toUpperCase()}</Text>
                    </TouchableOpacity>
                  ))}
                </View>
                <Text style={styles.label}>Additional Precautions</Text>
                <TextInput
                  style={styles.input}
                  value={formData?.jsea?.additionalPrecautions || ''}
                  onChangeText={text => setFormData({ ...formData, jsea: { ...formData.jsea, additionalPrecautions: text } })}
                  placeholder="Any additional precautions..."
                />
              </View>
            )}
          </View>
          {/* Sign-On Register Section */}
          <View style={styles.section}>
            <TouchableOpacity style={styles.sectionHeader} onPress={() => toggleSection('signons')}>
              <Text style={styles.sectionTitle}>Sign-On Register</Text>
              <Text style={styles.expandIcon}>{expandedSections.signons ? '‚ñ≤' : '‚ñº'}</Text>
            </TouchableOpacity>
            {expandedSections.signons && (
              <View style={styles.sectionContent}>
                {formData?.signOns?.map((signOn, idx) => (
                  <View key={idx} style={{ flexDirection: 'row', alignItems: 'center', marginBottom: 8 }}>
                    <TextInput
                      style={[styles.input, { flex: 1 }]}
                      value={signOn.name}
                      onChangeText={text => updateSignOn(idx, text)}
                      placeholder={`Person ${idx + 1} name`}
                    />
                    <TouchableOpacity onPress={() => removeSignOn(idx)} style={styles.removeButton}>
                      <Text style={{ color: 'red', fontWeight: 'bold', marginLeft: 8 }}>Remove</Text>
                    </TouchableOpacity>
                  </View>
                ))}
                <TouchableOpacity onPress={addSignOn} style={styles.addButton}>
                  <Text style={styles.addButtonText}>Add Person</Text>
                </TouchableOpacity>
              </View>
            )}
          </View>
          {/* Submit Button */}
          <View style={styles.submitSection}>
            <TouchableOpacity style={styles.submitButton} onPress={() => {}}>
              <Text style={styles.submitButtonText}>Create Permit</Text>
            </TouchableOpacity>
          </View>
        </ScrollView>
      </View>
    );
  }
  // App state for navigation and data
  const [currentScreen, setCurrentScreen] = useState('dashboard');
  const [permits, setPermits] = useState([]);
  const [selectedPermit, setSelectedPermit] = useState(null);
  const [editPermitData, setEditPermitData] = useState(null);
  const [formData, setFormData] = useState({
    id: '',
    description: '',
    requestedBy: '',
    location: '',
    status: 'pending_approval',
    priority: 'medium',
    startDate: '',
    startTime: '',
    endDate: '',
    endTime: '',
    specializedPermits: Object.fromEntries((specializedPermitTypes || []).map(type => [type.key, { required: false, questionnaire: {} }])),
    singleHazards: Object.fromEntries((singleHazardTypes || []).map(type => [type.key, { present: false, controls: '' }])),
    jsea: { taskSteps: [], overallRiskRating: '', additionalPrecautions: '' },
    signOns: []
  });
  const [showStartDatePicker, setShowStartDatePicker] = useState(false);
  const [showStartTimePicker, setShowStartTimePicker] = useState(false);
  const [showEndTimePicker, setShowEndTimePicker] = useState(false);
  const [expandedSections, setExpandedSections] = useState({
    general: true,
    specialized: false,
    hazards: false,
    jsea: false,
    signons: false
  });

  // Add a default permit for testing UI rendering
  useEffect(() => {
    if (permits.length === 0) {
      setPermits([
        {
          id: 'P-001',
          type: 'Hot Work Permit',
          description: 'Welding repairs in workshop',
          location: 'Workshop 1',
          requestedBy: 'John Doe',
          status: 'pending_approval',
          priority: 'medium',
          submittedDate: '2025-09-27',
          approvedDate: '',
          completedDate: '',
        },
      ]);
    }
  }, []);

  // Fallback: if currentScreen is undefined, reset to dashboard
  useEffect(() => {
    if (!currentScreen) {
      setCurrentScreen('dashboard');
    }
  }, [currentScreen]);

  // DEBUG: Show if component is rendering
  if (typeof global !== 'undefined') {
    if (!global.__permit_debug) {
      global.__permit_debug = true;
      console.log('PermitManagementApp is rendering');
    }
  }

  // Utility function for risk color
  function getRiskColor(risk) {
    switch (risk) {
      case 'low':
        return '#10B981'; // green
      case 'medium':
        return '#F59E42'; // orange
      case 'high':
        return '#EF4444'; // red
      default:
        return '#E5E7EB'; // gray
    }
  }

  // Helper to format date/time
  function formatDate(dateStr) {
    if (!dateStr) return '';
    const d = new Date(dateStr);
    if (isNaN(d)) return '';
    return d.toLocaleDateString();
  }
  function formatTime(timeStr) {
    if (!timeStr) return '';
    // timeStr: 'HH:MM' or ISO string
    if (timeStr.length > 5) {
      const d = new Date(timeStr);
      if (!isNaN(d)) return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }
    return timeStr;
  }

  // --- Handlers for advanced form ---
  const addSignOn = () => {
    setFormData(prev => ({
      ...prev,
      signOns: [...prev.signOns, { name: '' }]
    }));
  };
  const updateSignOn = (idx, value) => {
    setFormData(prev => {
      const updated = [...prev.signOns];
      updated[idx].name = value;
      return { ...prev, signOns: updated };
    });
  };
  const removeSignOn = (idx) => {
    setFormData(prev => {
      const updated = [...prev.signOns];
      updated.splice(idx, 1);
      return { ...prev, signOns: updated };
    });
  };
  const toggleSection = (section) => setExpandedSections(prev => ({ ...prev, [section]: !prev[section] }));
  const handleSpecializedPermitChange = (key, field, value) => {
    setFormData(prev => ({
      ...prev,
      specializedPermits: {
        ...prev.specializedPermits,
        [key]: { ...prev.specializedPermits[key], [field]: value }
      }
    }));
  };
  const handleSingleHazardChange = (key, field, value) => {
    setFormData(prev => ({
      ...prev,
      singleHazards: {
        ...prev.singleHazards,
        [key]: { ...prev.singleHazards[key], [field]: value }
      }
    }));
  };
  const handleQuestionnaireResponse = (permitKey, qid, value, field = 'answer') => {
    setFormData(prev => ({
      ...prev,
      specializedPermits: {
        ...prev.specializedPermits,
        [permitKey]: {
          ...prev.specializedPermits[permitKey],
          questionnaire: {
            ...prev.specializedPermits[permitKey].questionnaire,
            [qid]: {
              ...((prev.specializedPermits[permitKey].questionnaire && prev.specializedPermits[permitKey].questionnaire[qid]) || {}),
              [field]: value
            }
          }
        }
      }
    }));
  };
  const addJSEAStep = () => {
    setFormData(prev => ({
      ...prev,
      jsea: {
        ...prev.jsea,
        taskSteps: [...prev.jsea.taskSteps, { step: '', hazards: '', controls: '', riskLevel: '' }]
      }
    }));
  };
  const updateJSEAStep = (idx, field, value) => {
    setFormData(prev => {
      const steps = [...prev.jsea.taskSteps];
      steps[idx] = { ...steps[idx], [field]: value };
      return { ...prev, jsea: { ...prev.jsea, taskSteps: steps } };
    });
  };
  const removeJSEAStep = (idx) => {
    setFormData(prev => {
      const steps = [...prev.jsea.taskSteps];
      steps.splice(idx, 1);
      return { ...prev, jsea: { ...prev.jsea, taskSteps: steps } };
    });
  };

  // --- Placeholder implementations for missing render functions ---
  function renderDashboard() {
    // Dashboard UI from backup
    const counts = {
      pendingApproval: permits.filter(p => p.status === 'pending_approval').length,
      pendingInspection: permits.filter(p => p.status === 'pending_inspection').length,
      active: permits.filter(p => p.status === 'active').length,
      completed: permits.filter(p => p.status === 'completed').length
    };
    return (
      <View style={styles.screenContainer}>
        <View style={styles.header}>
          <Text style={styles.title}>Permit Management Dashboard</Text>
        </View>

        <ScrollView style={styles.content}>
          <View style={styles.dashboardGrid}>
            <TouchableOpacity 
              style={[styles.dashboardCard, { borderLeftColor: '#F59E0B' }]}
              onPress={() => setCurrentScreen('pending_approval')}
            >
              <Text style={styles.cardNumber}>{counts.pendingApproval}</Text>
              <Text style={styles.cardLabel}>Pending Approval</Text>
            </TouchableOpacity>

            <TouchableOpacity 
              style={[styles.dashboardCard, { borderLeftColor: '#EF4444' }]}
              onPress={() => setCurrentScreen('pending_inspection')}
            >
              <Text style={styles.cardNumber}>{counts.pendingInspection}</Text>
              <Text style={styles.cardLabel}>Needs Inspection</Text>
            </TouchableOpacity>

            <TouchableOpacity 
              style={[styles.dashboardCard, { borderLeftColor: '#10B981' }]}
              onPress={() => setCurrentScreen('active')}
            >
              <Text style={styles.cardNumber}>{counts.active}</Text>
              <Text style={styles.cardLabel}>Active Permits</Text>
            </TouchableOpacity>

            <TouchableOpacity 
              style={[styles.dashboardCard, { borderLeftColor: '#6B7280' }]}
              onPress={() => setCurrentScreen('completed')}
            >
              <Text style={styles.cardNumber}>{counts.completed}</Text>
              <Text style={styles.cardLabel}>Completed</Text>
            </TouchableOpacity>
          </View>

          <TouchableOpacity 
            style={styles.primaryButton}
            onPress={() => setCurrentScreen('new_permit')}
          >
            <Text style={styles.primaryButtonText}>Create New Permit</Text>
          </TouchableOpacity>
        </ScrollView>
      </View>
    );
  }
  function renderPermitList(status, title) {
    return (
      <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center', backgroundColor: '#F9FAFB' }}>
        <Text style={{ fontSize: 24, fontWeight: 'bold', color: '#2563EB' }}>{title} Placeholder</Text>
        <Text style={{ color: '#6B7280', marginTop: 10 }}>Implement permit list for status: {status}</Text>
      </View>
    );
  }
  function renderEditPermit() {
    return (
      <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center', backgroundColor: '#F9FAFB' }}>
        <Text style={{ fontSize: 24, fontWeight: 'bold', color: '#2563EB' }}>Edit Permit Placeholder</Text>
        <Text style={{ color: '#6B7280', marginTop: 10 }}>Implement edit permit UI here.</Text>
      </View>
    );
  }

  // Main render logic with error boundary
  let content;
  if (currentScreen === 'dashboard') {
    content = renderDashboard();
  } else if (currentScreen === 'new_permit') {
    content = renderNewPermitForm();
  } else if (currentScreen === 'edit_permit') {
    content = renderEditPermit();
  } else if ([
    'pending_approval',
    'pending_inspection',
    'active',
    'completed',
  ].includes(currentScreen)) {
    const titleMap = {
      pending_approval: 'Pending Approval',
      pending_inspection: 'Needs Inspection',
      active: 'Active Permits',
      completed: 'Completed',
    };
    content = renderPermitList(currentScreen, titleMap[currentScreen] || 'Permits');
  } else {
    console.log('Unknown screen value:', currentScreen);
    content = (
      <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center', backgroundColor: '#fff' }}>
        <Text style={{ color: 'red', fontSize: 18 }}>Unknown screen: {String(currentScreen)}</Text>
      </View>
    );
  }
  return (
    <ErrorBoundary>
      {/* Date/Time Pickers rendered at root so they are always on top */}
      <DatePickerModal
        visible={showStartDatePicker}
        onClose={() => setShowStartDatePicker(false)}
        onSelect={date => setFormData(prev => ({ ...prev, startDate: date }))}
        initialDate={formData.startDate}
      />
      <TimePickerModal
        visible={showStartTimePicker}
        onClose={() => setShowStartTimePicker(false)}
        onSelect={time => setFormData(prev => ({ ...prev, startTime: time }))}
        initialTime={formData.startTime}
      />
      <DatePickerModal
        visible={showEndDatePicker}
        onClose={() => setShowEndDatePicker(false)}
        onSelect={date => setFormData(prev => ({ ...prev, endDate: date }))}
        initialDate={formData.endDate}
      />
      <TimePickerModal
        visible={showEndTimePicker}
        onClose={() => setShowEndTimePicker(false)}
        onSelect={time => setFormData(prev => ({ ...prev, endTime: time }))}
        initialTime={formData.endTime}
      />
      {content}
    </ErrorBoundary>
  );
}
// --- Inline Date Picker Modal ---
function DatePickerModal({ visible, onClose, onSelect, initialDate }) {
  const today = new Date();
  const [displayMonth, setDisplayMonth] = React.useState(() => {
    const d = initialDate ? new Date(initialDate) : today;
    return new Date(d.getFullYear(), d.getMonth(), 1);
  });
  const [selectedDate, setSelectedDate] = React.useState(() => initialDate ? new Date(initialDate) : today);

  // Get days in month
  function getDaysInMonth(year, month) {
    return new Date(year, month + 1, 0).getDate();
  }
  // Get weekday of first day (0=Sun)
  function getFirstDayOfWeek(year, month) {
    return new Date(year, month, 1).getDay();
  }

  const year = displayMonth.getFullYear();
  const month = displayMonth.getMonth();
  const daysInMonth = getDaysInMonth(year, month);
  const firstDayOfWeek = getFirstDayOfWeek(year, month);
  const weeks = [];
  let day = 1 - firstDayOfWeek;
  for (let w = 0; w < 6; w++) {
    const week = [];
    for (let d = 0; d < 7; d++, day++) {
      if (day < 1 || day > daysInMonth) {
        week.push(null);
      } else {
        week.push(day);
      }
    }
    weeks.push(week);
    if (day > daysInMonth) break;
  }

  return visible ? (
    <View style={pickerStyles.overlay}>
      <View style={pickerStyles.modal}>
        <Text style={pickerStyles.title}>Select Date</Text>
        <View style={{ flexDirection: 'row', justifyContent: 'space-between', alignItems: 'center', marginBottom: 10 }}>
          <TouchableOpacity onPress={() => setDisplayMonth(new Date(year, month - 1, 1))}><Text style={{ fontSize: 20 }}>{'<'}</Text></TouchableOpacity>
          <Text style={{ fontSize: 16, fontWeight: 'bold' }}>{displayMonth.toLocaleString('default', { month: 'long' })} {year}</Text>
          <TouchableOpacity onPress={() => setDisplayMonth(new Date(year, month + 1, 1))}><Text style={{ fontSize: 20 }}>{'>'}</Text></TouchableOpacity>
        </View>
        <View style={{ flexDirection: 'row', justifyContent: 'space-between', marginBottom: 4 }}>
          {['S','M','T','W','T','F','S'].map(d => <Text key={d} style={{ width: 32, textAlign: 'center', fontWeight: 'bold' }}>{d}</Text>)}
        </View>
        {weeks.map((week, i) => (
          <View key={i} style={{ flexDirection: 'row', justifyContent: 'space-between' }}>
            {week.map((d, j) => d ? (
              <TouchableOpacity
                key={j}
                style={{
                  width: 32, height: 32, borderRadius: 16, alignItems: 'center', justifyContent: 'center',
                  backgroundColor: selectedDate.getFullYear() === year && selectedDate.getMonth() === month && selectedDate.getDate() === d ? '#2563EB' : 'transparent',
                }}
                onPress={() => setSelectedDate(new Date(year, month, d))}
              >
                <Text style={{ color: selectedDate.getFullYear() === year && selectedDate.getMonth() === month && selectedDate.getDate() === d ? 'white' : '#374151', fontWeight: 'bold' }}>{d}</Text>
              </TouchableOpacity>
            ) : <View key={j} style={{ width: 32 }} />)}
          </View>
        ))}
        <View style={pickerStyles.buttonContainer}>
          <TouchableOpacity style={pickerStyles.cancelButton} onPress={onClose}>
            <Text style={pickerStyles.cancelButtonText}>Cancel</Text>
          </TouchableOpacity>
          <TouchableOpacity style={pickerStyles.confirmButton} onPress={() => { onSelect(selectedDate.toISOString().slice(0, 10)); onClose(); }}>
            <Text style={pickerStyles.confirmButtonText}>Select</Text>
          </TouchableOpacity>
        </View>
      </View>
    </View>
  ) : null;
}

// --- Inline Time Picker Modal ---
function TimePickerModal({ visible, onClose, onSelect, initialTime }) {
  const [hour, setHour] = React.useState(initialTime ? parseInt(initialTime.split(':')[0]) : 8);
  const [minute, setMinute] = React.useState(initialTime ? parseInt(initialTime.split(':')[1]) : 0);
  // Scrollable arrays
  const hours = Array.from({ length: 24 }, (_, i) => i);
  const minutes = Array.from({ length: 60 }, (_, i) => i);

  return visible ? (
    <View style={pickerStyles.overlay}>
      <View style={pickerStyles.modal}>
        <Text style={pickerStyles.title}>Select Time</Text>
        <View style={{ flexDirection: 'row', justifyContent: 'center', alignItems: 'center', marginVertical: 20 }}>
          {/* Hour Picker */}
          <ScrollView style={{ height: 120 }} contentContainerStyle={{ alignItems: 'center' }} showsVerticalScrollIndicator={false}>
            {hours.map(h => (
              <TouchableOpacity key={h} onPress={() => setHour(h)}>
                <Text style={{ fontSize: 24, color: h === hour ? '#2563EB' : '#374151', fontWeight: h === hour ? 'bold' : 'normal', paddingVertical: 2 }}>{h.toString().padStart(2, '0')}</Text>
              </TouchableOpacity>
            ))}
          </ScrollView>
          <Text style={{ fontSize: 32, fontWeight: 'bold', marginHorizontal: 8 }}>:</Text>
          {/* Minute Picker */}
          <ScrollView style={{ height: 120 }} contentContainerStyle={{ alignItems: 'center' }} showsVerticalScrollIndicator={false}>
            {minutes.map(m => (
              <TouchableOpacity key={m} onPress={() => setMinute(m)}>
                <Text style={{ fontSize: 24, color: m === minute ? '#2563EB' : '#374151', fontWeight: m === minute ? 'bold' : 'normal', paddingVertical: 2 }}>{m.toString().padStart(2, '0')}</Text>
              </TouchableOpacity>
            ))}
          </ScrollView>
        </View>
        <View style={pickerStyles.buttonContainer}>
          <TouchableOpacity style={pickerStyles.cancelButton} onPress={onClose}>
            <Text style={pickerStyles.cancelButtonText}>Cancel</Text>
          </TouchableOpacity>
          <TouchableOpacity style={pickerStyles.confirmButton} onPress={() => { onSelect(`${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`); onClose(); }}>
            <Text style={pickerStyles.confirmButtonText}>Select</Text>
          </TouchableOpacity>
        </View>
      </View>
    </View>
  ) : null;
}

// Permit questionnaires from attachment
const permitQuestionnaires = {/* ...existing code omitted for brevity, see attachment ... */};

// Render dynamic questionnaire for a specialized permit
function renderQuestionnaire(permitKey, formData, handleQuestionnaireResponse, permitQuestionnaires, styles) {
  const questions = permitQuestionnaires[permitKey] || [];
  return questions.map(q => (
    <View key={q.id} style={{ marginBottom: 10 }}>
      <Text style={styles.label}>{q.text}</Text>
      {q.type === 'yesno' && (
        <View style={{ flexDirection: 'row', marginBottom: 4 }}>
          <TouchableOpacity
            style={[styles.choiceButton, { backgroundColor: (formData.specializedPermits[permitKey]?.questionnaire?.[q.id]?.answer === 'yes') ? '#10B981' : '#E5E7EB' }]}
            onPress={() => handleQuestionnaireResponse(permitKey, q.id, 'yes')}
          >
            <Text style={styles.choiceButtonText}>Yes</Text>
          </TouchableOpacity>
          <TouchableOpacity
            style={[styles.choiceButton, { backgroundColor: (formData.specializedPermits[permitKey]?.questionnaire?.[q.id]?.answer === 'no') ? '#EF4444' : '#E5E7EB' }]}
            onPress={() => handleQuestionnaireResponse(permitKey, q.id, 'no')}
          >
            <Text style={styles.choiceButtonText}>No</Text>
          </TouchableOpacity>
        </View>
      )}
      {q.type === 'yesno_text' && (
        <>
          <View style={{ flexDirection: 'row', marginBottom: 4 }}>
            <TouchableOpacity
              style={[styles.choiceButton, { backgroundColor: (formData.specializedPermits[permitKey]?.questionnaire?.[q.id]?.answer === 'yes') ? '#10B981' : '#E5E7EB' }]}
              onPress={() => handleQuestionnaireResponse(permitKey, q.id, 'yes')}
            >
              <Text style={styles.choiceButtonText}>Yes</Text>
            </TouchableOpacity>
            <TouchableOpacity
              style={[styles.choiceButton, { backgroundColor: (formData.specializedPermits[permitKey]?.questionnaire?.[q.id]?.answer === 'no') ? '#EF4444' : '#E5E7EB' }]}
              onPress={() => handleQuestionnaireResponse(permitKey, q.id, 'no')}
            >
              <Text style={styles.choiceButtonText}>No</Text>
            </TouchableOpacity>
          </View>
          <Text style={styles.label}>{q.textLabel || 'Details'}</Text>
          <TextInput
            style={styles.input}
            value={formData.specializedPermits[permitKey]?.questionnaire?.[q.id]?.text || ''}
            onChangeText={text => handleQuestionnaireResponse(permitKey, q.id, text, 'text')}
            placeholder={q.textLabel || 'Details'}
          />
        </>
      )}
      {q.type === 'text' && (
        <TextInput
          style={styles.input}
          value={formData.specializedPermits[permitKey]?.questionnaire?.[q.id]?.answer || ''}
          onChangeText={text => handleQuestionnaireResponse(permitKey, q.id, text)}
          placeholder={q.textLabel || 'Enter answer'}
        />
      )}
    </View>
  ));
}

const styles = StyleSheet.create({
  screenContainer: {
    flex: 1,
    backgroundColor: '#F9FAFB',
  },
  header: {
    backgroundColor: '#2563EB',
    padding: 20,
    paddingTop: 50,
    flexDirection: 'row',
    alignItems: 'center',
  },
  title: {
    fontSize: 20,
    fontWeight: 'bold',
    color: 'white',
    flex: 1,
  },
  backButton: {
    color: 'white',
    fontSize: 16,
    marginRight: 15,
  },
  content: {
    flex: 1,
  },
  dashboardGrid: {
    padding: 16,
    flexDirection: 'row',
    flexWrap: 'wrap',
    justifyContent: 'space-between',
  },
  dashboardCard: {
    backgroundColor: 'white',
    borderRadius: 8,
    padding: 16,
    marginBottom: 16,
    width: '48%',
    borderLeftWidth: 4,
    elevation: 2,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
  },
  cardNumber: {
    fontSize: 32,
    fontWeight: 'bold',
    color: '#111827',
  },
  cardLabel: {
    fontSize: 16,
    fontWeight: '600',
    color: '#374151',
    marginTop: 4,
  },
  primaryButton: {
    backgroundColor: '#2563EB',
    margin: 16,
    padding: 16,
    borderRadius: 8,
    alignItems: 'center',
  },
  primaryButtonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: '600',
  },
  permitList: {
    flex: 1,
  },
  permitListContainer: {
    padding: 16,
  },
  permitListCard: {
    backgroundColor: 'white',
    borderRadius: 8,
    padding: 16,
    marginBottom: 12,
    elevation: 2,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.22,
    shadowRadius: 2.22,
    position: 'relative',
  },
  permitListHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 8,
  },
  permitId: {
    fontSize: 16,
    fontWeight: 'bold',
    color: '#111827',
  },
  statusBadge: {
    paddingHorizontal: 8,
    paddingVertical: 4,
    borderRadius: 12,
  },
  statusText: {
    color: 'white',
    fontSize: 12,
    fontWeight: '600',
  },
  permitType: {
    fontSize: 14,
    fontWeight: '600',
    color: '#374151',
    marginBottom: 4,
  },
  permitDescription: {
    fontSize: 14,
    color: '#6B7280',
    marginBottom: 8,
  },
  permitDetails: {
    marginBottom: 8,
    marginTop: 16,
    paddingTop: 16,
    borderTopWidth: 1,
    borderTopColor: '#E5E7EB',
  },
  detailText: {
    fontSize: 12,
    color: '#9CA3AF',
    marginBottom: 2,
  },
  priorityIndicator: {
    position: 'absolute',
    top: 8,
    right: 8,
    paddingHorizontal: 6,
    paddingVertical: 2,
    borderRadius: 8,
  },
  priorityText: {
    color: 'white',
    fontSize: 10,
    fontWeight: 'bold',
  },
  emptyState: {
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 60,
  },
  emptyStateText: {
    fontSize: 16,
    color: '#9CA3AF',
    fontStyle: 'italic',
  },
  section: {
    margin: 16,
    backgroundColor: 'white',
    borderRadius: 8,
    overflow: 'hidden',
    elevation: 2,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.22,
    shadowRadius: 2.22,
  },
  sectionHeader: {
    backgroundColor: '#F3F4F6',
    padding: 16,
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
  },
  dangerHeader: {
    backgroundColor: '#FEF2F2',
  },
  warningHeader: {
    backgroundColor: '#FFFBEB',
  },
  infoHeader: {
    backgroundColor: '#EFF6FF',
  },
  sectionTitle: {
    fontSize: 18,
    fontWeight: '600',
    color: '#374151',
  },
  dangerTitle: {
    color: '#DC2626',
  },
  warningTitle: {
    color: '#D97706',
  },
  infoTitle: {
    color: '#2563EB',
  },
  expandIcon: {
    fontSize: 16,
    color: '#6B7280',
  },
  sectionContent: {
    padding: 16,
    flexGrow: 1,
    minHeight: 0,
  },
  label: {
    fontSize: 14,
    fontWeight: '500',
    color: '#374151',
    marginBottom: 4,
    marginTop: 12,
  },
  input: {
    borderWidth: 1,
    borderColor: '#D1D5DB',
    borderRadius: 6,
    padding: 12,
    fontSize: 16,
    backgroundColor: 'white',
  },
  textArea: {
    height: 80,
    textAlignVertical: 'top',
  },
  permitCard: {
    borderWidth: 1,
    borderColor: '#E5E7EB',
    borderRadius: 8,
    padding: 16,
    marginBottom: 16,
    backgroundColor: '#F9FAFB',
  },
  permitHeader: {
    flexDirection: 'row',
    alignItems: 'flex-start',
  },
  permitInfo: {
    flex: 1,
    marginLeft: 12,
  },
  permitLabel: {
    fontSize: 16,
    fontWeight: '600',
    color: '#111827',
  },
  questionnaireTitle: {
    fontSize: 16,
    fontWeight: '600',
    color: '#111827',
    marginBottom: 12,
  },
  questionnaireScroll: {
    flexGrow: 1,
    minHeight: 0,
  },
  questionContainer: {
    backgroundColor: '#F3F4F6',
    padding: 12,
    borderRadius: 6,
    marginBottom: 8,
    borderWidth: 1,
    borderColor: '#E5E7EB',
  },
  questionText: {
    fontSize: 14,
    fontWeight: '500',
    color: '#374151',
    marginBottom: 8,
  },
  required: {
    color: '#EF4444',
  },
  noteText: {
    fontSize: 12,
    color: '#6B7280',
    fontStyle: 'italic',
    marginBottom: 8,
  },
  radioGroup: {
    flexDirection: 'row',
    justifyContent: 'flex-start',
  },
  radioOption: {
    flexDirection: 'row',
    alignItems: 'center',
    marginRight: 20,
  },
  radioCircle: {
    height: 20,
    width: 20,
    borderRadius: 10,
    borderWidth: 2,
    borderColor: '#D1D5DB',
    alignItems: 'center',
    justifyContent: 'center',
    marginRight: 6,
  },
  radioSelected: {
    borderColor: '#2563EB',
    backgroundColor: '#2563EB',
  },
  radioLabel: {
    fontSize: 14,
    color: '#374151',
  },
  textInputContainer: {
    marginTop: 8,
  },
  textLabel: {
    fontSize: 14,
    fontWeight: '500',
    color: '#6B7280',
    marginBottom: 4,
  },
  detailTextInput: {
    borderWidth: 1,
    borderColor: '#D1D5DB',
    borderRadius: 6,
    padding: 8,
    fontSize: 14,
    backgroundColor: 'white',
    textAlignVertical: 'top',
    minHeight: 60,
  },
  addButton: {
    backgroundColor: '#2563EB',
    padding: 12,
    borderRadius: 6,
    alignItems: 'center',
    marginBottom: 16,
  },
  addButtonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: '600',
  },
  jseaStep: {
    backgroundColor: '#F9FAFB',
    padding: 16,
    borderRadius: 8,
    marginBottom: 16,
    borderWidth: 1,
    borderColor: '#E5E7EB',
  },
  stepHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 12,
  },
  stepTitle: {
    fontSize: 16,
    fontWeight: '600',
    color: '#111827',
  },
  removeButton: {
    color: '#EF4444',
    fontSize: 14,
    fontWeight: '500',
  },
  riskButtons: {
    flexDirection: 'row',
    justifyContent: 'space-around',
    marginTop: 8,
  },
  riskButton: {
    paddingVertical: 8,
    paddingHorizontal: 16,
    borderRadius: 6,
    minWidth: 80,
    alignItems: 'center',
  },
  riskButtonText: {
    fontSize: 12,
    fontWeight: '600',
  },
  submitSection: {
    flexDirection: 'row',
    justifyContent: 'space-around',
    padding: 16,
    backgroundColor: 'white',
    margin: 16,
    borderRadius: 8,
    elevation: 2,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.22,
    shadowRadius: 2.22,
  },
  draftButton: {
    flex: 0.45,
    padding: 12,
    borderWidth: 1,
    borderColor: '#D1D5DB',
    borderRadius: 6,
    alignItems: 'center',
  },
  draftButtonText: {
    color: '#374151',
    fontSize: 16,
    fontWeight: '600',
  },
  submitButton: {
    flex: 0.45,
    padding: 12,
    backgroundColor: '#2563EB',
    borderRadius: 6,
    alignItems: 'center',
  },
  submitButtonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: '600',
  },
  dateTimeRow: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    marginTop: 8,
  },
  dateTimeColumn: {
    flex: 0.48,
  },
  dateTimeInput: {
    borderWidth: 1,
    borderColor: '#D1D5DB',
    borderRadius: 6,
    padding: 12,
    backgroundColor: 'white',
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    minHeight: 48,
  },
  dateTimeText: {
    fontSize: 16,
    color: '#374151',
    flex: 1,
  },
  placeholderText: {
    color: '#9CA3AF',
  },
  calendarIcon: {
    fontSize: 18,
  },
  priorityButtons: {
    flexDirection: 'row',
    justifyContent: 'space-around',
    marginTop: 8,
  },
  priorityButton: {
    paddingVertical: 8,
    paddingHorizontal: 16,
    borderRadius: 6,
    minWidth: 80,
    alignItems: 'center',
  },
  priorityButtonText: {
    fontSize: 12,
    fontWeight: '600',
  },
});

// DateTimePicker Styles
const pickerStyles = StyleSheet.create({
  overlay: {
    flex: 1,
    backgroundColor: 'rgba(0, 0, 0, 0.5)',
    justifyContent: 'center',
    alignItems: 'center',
  },
  modal: {
    backgroundColor: 'white',
    borderRadius: 12,
    padding: 20,
    margin: 20,
    maxHeight: '80%',
    width: '90%',
  },
  header: {
    alignItems: 'center',
    marginBottom: 20,
  },
  title: {
    fontSize: 18,
    fontWeight: '600',
    color: '#111827',
  },
  dateContainer: {
    alignItems: 'center',
  },
  dateHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    width: '100%',
    marginBottom: 20,
  },
  yearButton: {
    fontSize: 16,
    color: '#2563EB',
    fontWeight: '500',
  },
  currentYear: {
    fontSize: 20,
    fontWeight: 'bold',
    color: '#111827',
  },
  monthContainer: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    justifyContent: 'center',
    marginBottom: 20,
  },
  monthButton: {
    padding: 8,
    margin: 4,
    borderRadius: 6,
    minWidth: 50,
    alignItems: 'center',
  },
  selectedMonth: {
    backgroundColor: '#2563EB',
  },
  monthText: {
    fontSize: 14,
    color: '#374151',
  },
  selectedMonthText: {
    color: 'white',
  },
  dayContainer: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    justifyContent: 'center',
    maxWidth: 280,
  },
  dayButton: {
    width: 35,
    height: 35,
    margin: 2,
    borderRadius: 18,
    alignItems: 'center',
    justifyContent: 'center',
  },
  selectedDay: {
    backgroundColor: '#2563EB',
  },
  dayText: {
    fontSize: 14,
    color: '#374151',
  },
  selectedDayText: {
    color: 'white',
  },
  timeContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    height: 200,
  },
  timeSection: {
    alignItems: 'center',
    width: 80,
  },
  timeLabel: {
    fontSize: 16,
    fontWeight: '600',
    color: '#111827',
    marginBottom: 10,
  },
  timeScroll: {
    height: 150,
  },
  timeOption: {
    padding: 8,
    alignItems: 'center',
    borderRadius: 6,
    marginVertical: 2,
  },
  selectedTimeOption: {
    backgroundColor: '#2563EB',
  },
  timeOptionText: {
    fontSize: 16,
    color: '#374151',
  },
  selectedTimeOptionText: {
    color: 'white',
  },
  timeSeparator: {
    fontSize: 24,
    fontWeight: 'bold',
    color: '#111827',
    marginHorizontal: 20,
  },
  buttonContainer: {
    flexDirection: 'row',
    justifyContent: 'space-around',
    marginTop: 20,
   },
  cancelButton: {
    flex: 0.4,
    padding: 12,
    borderWidth: 1,
    borderColor: '#D1D5DB',
    borderRadius: 6,
    alignItems: 'center',
  },
  cancelButtonText: {
    color: '#374151',
    fontSize: 16,
    fontWeight: '600',
  },
  confirmButton: {
    flex: 0.4,
    padding: 12,
    backgroundColor: '#2563EB',
    borderRadius: 6,
    alignItems: 'center',
  },
  confirmButtonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: '600',
  },
});
export default PermitManagementApp;